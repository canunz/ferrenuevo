{"ast":null,"code":"import React,{useState}from'react';import api from'../../servicios/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MovimientoStock=_ref=>{let{productoId,modoCompacto,onMovimientoExitoso}=_ref;const[cantidad,setCantidad]=useState(0);const[mensaje,setMensaje]=useState('');const[cargando,setCargando]=useState(false);const handleMovimiento=async tipo=>{setMensaje('');setCargando(true);try{const data={producto_id:productoId,cantidad:Number(cantidad),tipo:tipo==='ingreso'?'entrada':'salida',motivo:tipo==='ingreso'?'Ingreso manual de stock':'Egreso manual de stock',observaciones:''};console.log('üîç Datos a enviar:',data);console.log('üîç productoId:',productoId);console.log('üîç cantidad:',cantidad);console.log('üîç Token disponible:',!!localStorage.getItem('token'));// Usar la API real de movimientos\nconst res=await api.post('/inventario/movimientos',data);setMensaje('‚úÖ Movimiento registrado');setCantidad(0);if(onMovimientoExitoso&&res&&res.data&&res.data.datos){onMovimientoExitoso(res.data.datos);}}catch(err){console.error('‚ùå Error en handleMovimiento:',err);console.error('‚ùå Error response:',err.response);let errorMsg='No se pudo registrar el movimiento';if(err.response&&err.response.data){errorMsg=err.response.data.error||err.response.data.message||errorMsg;}setMensaje('‚ùå '+errorMsg);}finally{setCargando(false);}};if(modoCompacto){return/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),style:{display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:cantidad,onChange:e=>setCantidad(e.target.value),min:\"1\",required:true,style:{width:60,height:32},placeholder:\"Cantidad\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:cargando||cantidad<=0,onClick:()=>handleMovimiento('ingreso'),style:{height:32,padding:'0 12px',background:'#22c55e',color:'white',borderRadius:4,border:'none',fontWeight:'bold',fontSize:18},title:\"Sumar al stock\",children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:cargando||cantidad<=0,onClick:()=>handleMovimiento('egreso'),style:{height:32,padding:'0 12px',background:'#ef4444',color:'white',borderRadius:4,border:'none',fontWeight:'bold',fontSize:18},title:\"Restar del stock\",children:\"\\u2013\"}),mensaje&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:12,marginLeft:8},children:mensaje})]});}// Versi√≥n no compacta (opcional, por si se usa en otro contexto)\nreturn/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),style:{display:'flex',flexDirection:'column',gap:'0.5rem',maxWidth:350},children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Cantidad:\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:cantidad,onChange:e=>setCantidad(e.target.value),min:\"1\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:cargando||cantidad<=0,onClick:()=>handleMovimiento('ingreso'),style:{height:32,padding:'0 12px',background:'#22c55e',color:'white',borderRadius:4,border:'none',fontWeight:'bold',fontSize:18},children:\"+ Ingreso\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:cargando||cantidad<=0,onClick:()=>handleMovimiento('egreso'),style:{height:32,padding:'0 12px',background:'#ef4444',color:'white',borderRadius:4,border:'none',fontWeight:'bold',fontSize:18},children:\"\\u2013 Egreso\"})]}),mensaje&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:mensaje})]});};export default MovimientoStock;","map":{"version":3,"names":["React","useState","api","jsx","_jsx","jsxs","_jsxs","MovimientoStock","_ref","productoId","modoCompacto","onMovimientoExitoso","cantidad","setCantidad","mensaje","setMensaje","cargando","setCargando","handleMovimiento","tipo","data","producto_id","Number","motivo","observaciones","console","log","localStorage","getItem","res","post","datos","err","error","response","errorMsg","message","onSubmit","e","preventDefault","style","display","alignItems","gap","children","type","value","onChange","target","min","required","width","height","placeholder","disabled","onClick","padding","background","color","borderRadius","border","fontWeight","fontSize","title","marginLeft","flexDirection","maxWidth","marginTop"],"sources":["C:/ferrenuevo/fronted/src/componentes/inventario/MovimientoStock.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport api from '../../servicios/api';\r\n\r\nconst MovimientoStock = ({ productoId, modoCompacto, onMovimientoExitoso }) => {\r\n  const [cantidad, setCantidad] = useState(0);\r\n  const [mensaje, setMensaje] = useState('');\r\n  const [cargando, setCargando] = useState(false);\r\n\r\n  const handleMovimiento = async (tipo) => {\r\n    setMensaje('');\r\n    setCargando(true);\r\n    try {\r\n      const data = {\r\n        producto_id: productoId,\r\n        cantidad: Number(cantidad),\r\n        tipo: tipo === 'ingreso' ? 'entrada' : 'salida',\r\n        motivo: tipo === 'ingreso' ? 'Ingreso manual de stock' : 'Egreso manual de stock',\r\n        observaciones: ''\r\n      };\r\n      console.log('üîç Datos a enviar:', data);\r\n      console.log('üîç productoId:', productoId);\r\n      console.log('üîç cantidad:', cantidad);\r\n      console.log('üîç Token disponible:', !!localStorage.getItem('token'));\r\n\r\n      // Usar la API real de movimientos\r\n      const res = await api.post('/inventario/movimientos', data);\r\n      setMensaje('‚úÖ Movimiento registrado');\r\n      setCantidad(0);\r\n      if (onMovimientoExitoso && res && res.data && res.data.datos) {\r\n        onMovimientoExitoso(res.data.datos);\r\n      }\r\n    } catch (err) {\r\n      console.error('‚ùå Error en handleMovimiento:', err);\r\n      console.error('‚ùå Error response:', err.response);\r\n      let errorMsg = 'No se pudo registrar el movimiento';\r\n      if (err.response && err.response.data) {\r\n        errorMsg = err.response.data.error || err.response.data.message || errorMsg;\r\n      }\r\n      setMensaje('‚ùå ' + errorMsg);\r\n    } finally {\r\n      setCargando(false);\r\n    }\r\n  };\r\n\r\n  if (modoCompacto) {\r\n    return (\r\n      <form onSubmit={e => e.preventDefault()} style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n        <input\r\n          type=\"number\"\r\n          value={cantidad}\r\n          onChange={e => setCantidad(e.target.value)}\r\n          min=\"1\"\r\n          required\r\n          style={{ width: 60, height: 32 }}\r\n          placeholder=\"Cantidad\"\r\n        />\r\n        <button\r\n          type=\"button\"\r\n          disabled={cargando || cantidad <= 0}\r\n          onClick={() => handleMovimiento('ingreso')}\r\n          style={{ height: 32, padding: '0 12px', background: '#22c55e', color: 'white', borderRadius: 4, border: 'none', fontWeight: 'bold', fontSize: 18 }}\r\n          title=\"Sumar al stock\"\r\n        >\r\n          +\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          disabled={cargando || cantidad <= 0}\r\n          onClick={() => handleMovimiento('egreso')}\r\n          style={{ height: 32, padding: '0 12px', background: '#ef4444', color: 'white', borderRadius: 4, border: 'none', fontWeight: 'bold', fontSize: 18 }}\r\n          title=\"Restar del stock\"\r\n        >\r\n          ‚Äì\r\n        </button>\r\n        {mensaje && <span style={{ fontSize: 12, marginLeft: 8 }}>{mensaje}</span>}\r\n      </form>\r\n    );\r\n  }\r\n\r\n  // Versi√≥n no compacta (opcional, por si se usa en otro contexto)\r\n  return (\r\n    <form onSubmit={e => e.preventDefault()} style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', maxWidth: 350 }}>\r\n      <label>\r\n        Cantidad:\r\n        <input type=\"number\" value={cantidad} onChange={e => setCantidad(e.target.value)} min=\"1\" required />\r\n      </label>\r\n      <div style={{ display: 'flex', gap: 8 }}>\r\n        <button\r\n          type=\"button\"\r\n          disabled={cargando || cantidad <= 0}\r\n          onClick={() => handleMovimiento('ingreso')}\r\n          style={{ height: 32, padding: '0 12px', background: '#22c55e', color: 'white', borderRadius: 4, border: 'none', fontWeight: 'bold', fontSize: 18 }}\r\n        >\r\n          + Ingreso\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          disabled={cargando || cantidad <= 0}\r\n          onClick={() => handleMovimiento('egreso')}\r\n          style={{ height: 32, padding: '0 12px', background: '#ef4444', color: 'white', borderRadius: 4, border: 'none', fontWeight: 'bold', fontSize: 18 }}\r\n        >\r\n          ‚Äì Egreso\r\n        </button>\r\n      </div>\r\n      {mensaje && <div style={{ marginTop: 8 }}>{mensaje}</div>}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default MovimientoStock;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}